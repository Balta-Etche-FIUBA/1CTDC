Version 4
SHEET 1 3096 688
WIRE 1968 -656 1872 -656
WIRE 2112 -656 2032 -656
WIRE 1776 -528 1744 -528
WIRE 1648 -480 1648 -528
WIRE 1616 -464 1472 -464
WIRE 1952 -464 1952 -496
WIRE 1744 -448 1744 -528
WIRE 1744 -448 1680 -448
WIRE 1776 -448 1744 -448
WIRE 1872 -448 1872 -656
WIRE 1872 -448 1856 -448
WIRE 1920 -448 1872 -448
WIRE 1616 -432 1552 -432
WIRE 2112 -432 2112 -656
WIRE 2112 -432 1984 -432
WIRE 2160 -432 2112 -432
WIRE 1920 -416 1872 -416
WIRE 2640 -400 2640 -432
WIRE 2640 -400 2480 -400
WIRE 2928 -400 2640 -400
WIRE 1648 -384 1648 -416
WIRE 1952 -352 1952 -400
WIRE 2480 -352 2480 -400
WIRE 1552 -304 1552 -432
WIRE 1616 -304 1552 -304
WIRE 1744 -304 1744 -448
WIRE 1744 -304 1696 -304
WIRE 2224 -240 2224 -288
WIRE 2224 -224 2224 -240
WIRE 1552 -208 1552 -304
WIRE 1616 -208 1552 -208
WIRE 2112 -208 2112 -432
WIRE 2112 -208 1696 -208
WIRE 2192 -208 2112 -208
WIRE 2640 -208 2640 -400
WIRE 2480 -192 2480 -272
WIRE 2480 -192 2272 -192
WIRE 2592 -192 2480 -192
WIRE 2928 -192 2928 -400
WIRE 2192 -176 2064 -176
WIRE 2480 -160 2480 -192
WIRE 2528 -160 2480 -160
WIRE 2224 -144 2224 -160
WIRE 2064 -112 2064 -176
WIRE 2096 -112 2064 -112
WIRE 1472 -96 1472 -464
WIRE 1872 -96 1872 -416
WIRE 1872 -96 1472 -96
WIRE 2064 -80 2064 -112
WIRE 2640 -80 2640 -112
WIRE 2928 -80 2928 -128
WIRE 2928 -80 2640 -80
WIRE 2976 -80 2928 -80
WIRE 2224 -48 2224 -144
WIRE 1248 0 1248 -48
WIRE 1376 0 1248 0
WIRE 1376 16 1376 0
WIRE 2928 32 2928 -80
WIRE 240 48 32 48
WIRE 544 48 336 48
WIRE 688 48 544 48
WIRE 864 48 768 48
WIRE 1008 48 864 48
WIRE 1248 64 1248 0
WIRE 1552 64 1552 16
WIRE 2064 64 2064 0
WIRE 2640 64 2640 -80
WIRE 1472 80 1472 -96
WIRE 1520 80 1472 80
WIRE 1872 96 1872 -96
WIRE 1872 96 1584 96
WIRE 32 112 32 48
WIRE 544 112 544 48
WIRE 1376 112 1376 96
WIRE 1520 112 1376 112
WIRE 1376 128 1376 112
WIRE 256 144 256 96
WIRE 320 144 256 144
WIRE 864 144 864 48
WIRE 1008 144 1008 48
WIRE 1552 176 1552 128
WIRE 1248 272 1248 144
WIRE 1376 272 1376 208
WIRE 32 320 32 192
WIRE 544 320 544 208
WIRE 544 320 32 320
WIRE 864 320 864 208
WIRE 864 320 544 320
WIRE 1008 320 1008 224
WIRE 1008 320 864 320
WIRE 2640 336 2640 144
WIRE 2928 336 2928 96
WIRE 2928 336 2640 336
WIRE 2640 352 2640 336
FLAG 864 320 0
FLAG 864 48 Vo
FLAG 320 144 Vg
FLAG 544 48 Vd
FLAG 1376 272 0
FLAG 1248 272 0
FLAG 2640 352 0
FLAG 1952 -352 0
FLAG 1552 176 0
FLAG 2224 -48 0
FLAG 1648 -384 0
FLAG 1248 -48 VCC
IOPIN 1248 -48 BiDir
FLAG 1648 -528 VCC
IOPIN 1648 -528 BiDir
FLAG 1952 -496 VCC
IOPIN 1952 -496 BiDir
FLAG 2640 -432 VCC
IOPIN 2640 -432 BiDir
FLAG 1552 16 VCC
IOPIN 1552 16 BiDir
FLAG 1776 -528 Va
IOPIN 1776 -528 Out
FLAG 2160 -432 Vb
IOPIN 2160 -432 Out
FLAG 2064 64 0
FLAG 2224 -288 VCC
IOPIN 2224 -288 BiDir
FLAG 2096 -112 Vr
IOPIN 2096 -112 Out
FLAG 2976 -80 Vong
IOPIN 2976 -80 Out
FLAG 2528 -160 Vg
IOPIN 2528 -160 Out
FLAG 496 128 Vong
SYMBOL voltage 32 96 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value {V1}
SYMBOL ind 672 64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 300µ
SYMBOL cap 848 144 R0
SYMATTR InstName C1
SYMATTR Value 5µ
SYMBOL pmos 336 96 M270
SYMATTR InstName M1
SYMATTR Value IRF9640
SYMBOL res 992 128 R0
SYMATTR InstName RL
SYMATTR Value 100
SYMBOL pmos 496 208 M180
SYMATTR InstName M2
SYMATTR Value IRF9640
SYMBOL OpAmps\\LM324 1648 -448 R0
SYMATTR InstName U1
SYMBOL OpAmps\\LM324 1952 -432 R0
SYMATTR InstName U2
SYMBOL OpAmps\\LM324 1552 96 R0
SYMATTR InstName U3
SYMBOL res 1872 -464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res 1360 0 R0
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL res 1360 112 R0
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL voltage 1248 48 R0
SYMATTR InstName V4
SYMATTR Value 12
SYMBOL res 1712 -320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res 1712 -224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 47k
SYMBOL diode 2944 96 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N4002
SYMBOL voltage 2064 -96 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value SINE(6.25 2 200)
SYMBOL cap 2032 -672 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 10n
SYMBOL pmos 2592 -112 M180
SYMATTR InstName M3
SYMATTR Value IRF9540
SYMBOL schottky 2944 -128 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value 1N5817
SYMBOL res 2496 -256 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 1.8k
SYMBOL res 2624 48 R0
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL Comparators\\LTC6702 2224 -192 R0
SYMATTR InstName U5
TEXT 32 416 Left 2 !.tran 0 0.5m 0
TEXT 32 448 Left 2 !;step param V1 12 30 1
TEXT 32 480 Left 2 !.param Ton = (9.7/{V1})*8.33u
TEXT 24 552 Left 2 !.model IRF9540 PMOS(Level=3 Gamma=0 Delta=0 Eta=0 Theta=0 Kappa=0.2 Vmax=0 Xj=0\n+ Tox=100n Uo=300 Phi=.6 Rs=64.15m Kp=10.18u W=1.5 L=2u\n+ Vto=-3.646 Rd=62.45m Rds=444.4K Cbd=2.029n Pb=.8 Mj=.5 Fc=.5\n+ Cgso=1.033n Cgdo=469.4p Rg=.3371 Is=54.08E-18 N=2 Tt=140n)
TEXT 32 672 Left 2 !.model 1N4002 D (Is=14.11n N=1.984 Rs=33.89E-3 Ikf=94.81 Xti=3 Eg=1.110 Cjo=51.17E-12)
TEXT 32 512 Left 2 !.param V1 12
