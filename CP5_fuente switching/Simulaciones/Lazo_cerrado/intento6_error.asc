Version 4.1
SHEET 1 3160 1976
WIRE 48 -80 -16 -80
WIRE 112 -80 48 -80
WIRE 208 -80 112 -80
WIRE 368 -80 304 -80
WIRE 448 -80 368 -80
WIRE 480 -80 448 -80
WIRE 640 -80 560 -80
WIRE 768 -80 640 -80
WIRE 896 -80 768 -80
WIRE 1024 -80 896 -80
WIRE 896 -48 896 -80
WIRE 1024 -48 1024 -80
WIRE 288 -32 240 -32
WIRE -448 0 -528 0
WIRE -304 0 -384 0
WIRE 448 16 448 -80
WIRE 640 16 640 -80
WIRE 768 16 768 -80
WIRE -672 32 -768 32
WIRE 48 32 48 -80
WIRE 112 32 112 -80
WIRE 240 32 240 -32
WIRE 1024 64 1024 32
WIRE 1136 64 1024 64
WIRE 1184 64 1136 64
WIRE 1024 80 1024 64
WIRE 368 96 352 96
WIRE 400 96 368 96
WIRE -672 144 -672 112
WIRE 48 192 48 96
WIRE 80 192 48 192
WIRE 112 192 112 96
WIRE 112 192 80 192
WIRE 448 192 448 112
WIRE 560 192 448 192
WIRE 640 192 640 80
WIRE 640 192 560 192
WIRE 768 192 768 80
WIRE 768 192 640 192
WIRE 896 192 896 32
WIRE 896 192 768 192
WIRE 1024 192 1024 160
WIRE 1024 192 896 192
WIRE 80 208 80 192
WIRE -768 224 -768 32
WIRE 240 224 240 32
WIRE 352 224 352 96
WIRE 560 224 560 192
WIRE -800 240 -944 240
WIRE -464 240 -464 176
WIRE -672 256 -672 144
WIRE -672 256 -736 256
WIRE -640 256 -672 256
WIRE -528 256 -528 0
WIRE -528 256 -560 256
WIRE -496 256 -528 256
WIRE -800 272 -864 272
WIRE -304 272 -304 0
WIRE -304 272 -432 272
WIRE -256 272 -304 272
WIRE -496 288 -544 288
WIRE -768 320 -768 288
WIRE 640 320 624 320
WIRE 816 320 640 320
WIRE 816 336 816 320
WIRE -464 352 -464 304
WIRE -864 400 -864 272
WIRE -800 400 -864 400
WIRE -672 400 -672 256
WIRE -672 400 -720 400
WIRE 816 416 816 400
WIRE 816 416 720 416
WIRE 352 432 352 304
WIRE 432 432 352 432
WIRE 576 432 560 432
WIRE 624 432 624 320
WIRE 624 432 576 432
WIRE 816 432 816 416
WIRE 240 464 240 304
WIRE 432 464 240 464
WIRE 720 464 720 416
WIRE 720 464 560 464
WIRE -864 496 -864 400
WIRE -800 496 -864 496
WIRE -304 496 -304 272
WIRE -304 496 -720 496
WIRE -176 496 -176 480
WIRE -16 496 -176 496
WIRE 432 496 384 496
WIRE 768 496 560 496
WIRE 816 496 768 496
WIRE 432 528 416 528
WIRE 624 528 560 528
WIRE -176 544 -176 496
WIRE -1552 560 -1552 496
WIRE -944 560 -944 240
WIRE -544 560 -544 288
WIRE -544 560 -944 560
WIRE -304 560 -304 496
WIRE -208 560 -304 560
WIRE -16 576 -144 576
WIRE 192 576 -16 576
WIRE 416 576 416 528
WIRE 416 576 192 576
WIRE -1824 592 -1824 544
WIRE -1696 592 -1696 544
WIRE -1392 592 -1392 560
WIRE -208 592 -336 592
WIRE -16 592 -16 576
WIRE 576 608 576 432
WIRE -1088 640 -1088 624
WIRE 384 672 384 496
WIRE 576 672 384 672
WIRE -944 704 -944 560
WIRE -896 704 -944 704
WIRE -176 704 -176 608
WIRE -16 704 -16 656
WIRE -16 704 -176 704
WIRE -1824 720 -1824 672
WIRE -1696 720 -1696 672
WIRE -1696 720 -1824 720
WIRE -1552 720 -1552 640
WIRE -1552 720 -1696 720
WIRE -1392 720 -1392 672
WIRE -1392 720 -1552 720
WIRE -544 720 -544 560
WIRE -544 720 -832 720
WIRE -176 720 -176 704
WIRE 384 720 384 672
WIRE -1088 736 -1088 720
WIRE -896 736 -1088 736
WIRE -1088 752 -1088 736
WIRE -1552 768 -1552 720
WIRE -864 800 -864 752
WIRE 272 880 272 784
WIRE 272 880 240 880
WIRE 304 880 272 880
WIRE 416 880 416 784
WIRE 416 880 368 880
WIRE 432 880 416 880
WIRE -1088 896 -1088 832
WIRE 432 976 432 880
WIRE 528 976 528 864
WIRE 528 976 432 976
WIRE 544 976 528 976
WIRE 672 976 672 864
WIRE 672 976 624 976
WIRE 1184 976 1184 64
WIRE 1184 976 672 976
WIRE 432 1072 432 976
WIRE 432 1072 384 1072
WIRE -336 1088 -336 592
WIRE 96 1088 -336 1088
WIRE 240 1088 240 880
WIRE 240 1088 96 1088
WIRE 320 1088 240 1088
WIRE 496 1104 384 1104
WIRE 560 1104 496 1104
WIRE 640 1104 560 1104
WIRE 736 1104 720 1104
WIRE 560 1136 560 1104
WIRE 560 1136 528 1136
WIRE 496 1152 496 1104
WIRE 352 1168 352 1120
WIRE 528 1184 528 1136
FLAG 368 -80 Vd
FLAG 768 -80 Vout
FLAG 384 720 0
FLAG -1088 896 0
FLAG -464 352 0
FLAG -864 800 0
FLAG -176 720 0
FLAG -768 320 0
FLAG -1696 544 VCCPWM
IOPIN -1696 544 BiDir
FLAG -768 32 VCCPWM
IOPIN -768 32 BiDir
FLAG -464 176 VCCPWM
IOPIN -464 176 BiDir
FLAG -864 688 VCCPWM
IOPIN -864 688 BiDir
FLAG -672 144 Cuadrada
IOPIN -672 144 Out
FLAG -256 272 Triangular
IOPIN -256 272 Out
FLAG -176 480 VCCPWM
IOPIN -176 480 BiDir
FLAG -1552 496 Vin
IOPIN -1552 496 BiDir
FLAG 560 224 0
FLAG 352 1056 VCCPWM
IOPIN 352 1056 BiDir
FLAG -672 464 0
FLAG 240 32 Vg1
FLAG 368 96 Vg2
FLAG 96 1088 error
FLAG 192 576 pwm
FLAG 1136 64 sampling
FLAG -1088 624 VCCPWM
IOPIN -1088 624 BiDir
FLAG -16 -80 Vin
IOPIN -16 -80 BiDir
FLAG -1392 560 Vref
IOPIN -1392 560 BiDir
FLAG -1552 768 0
FLAG 624 528 VCCPWM
IOPIN 624 528 BiDir
FLAG 80 208 0
FLAG -1824 544 -VCCPWM
IOPIN -1824 544 BiDir
FLAG 352 1168 0
FLAG 640 320 VCCPWM
IOPIN 640 320 BiDir
FLAG 736 1104 VCCPWM
IOPIN 736 1104 BiDir
FLAG 496 1216 0
FLAG 768 496 Vd
SYMBOL voltage -1552 544 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL ind 464 -64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 300µ
SYMBOL cap 624 16 R0
SYMATTR InstName C1
SYMATTR Value 10µ
SYMBOL nmos 400 16 R0
SYMATTR InstName M3
SYMATTR Value IRFZ44N
SYMBOL nmos 208 -32 R270
SYMATTR InstName M4
SYMATTR Value IRFZ44N
SYMBOL res 224 208 R0
SYMATTR InstName R2
SYMATTR Value 20
SYMBOL cap 96 32 R0
SYMATTR InstName C2
SYMATTR Value 470µ
SYMBOL cap 752 16 R0
SYMATTR InstName C3
SYMATTR Value 1n
SYMBOL res 336 208 R0
SYMATTR InstName R3
SYMATTR Value 20
SYMBOL diode 800 336 R0
SYMATTR InstName D1
SYMATTR Value 1N5817
SYMBOL cap 800 432 R0
SYMATTR InstName C4
SYMATTR Value 10n
SYMBOL IR2104 496 480 R0
SYMATTR InstName U1
SYMBOL cap 32 32 R0
SYMATTR InstName C5
SYMATTR Value 10µ
SYMBOL res -544 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL res -1104 624 R0
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res -1104 736 R0
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL res -704 384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName 70k
SYMATTR Value 100k
SYMBOL res -704 480 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 47k
SYMBOL cap -384 -16 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 33p
SYMBOL res -688 16 R0
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL res -32 480 R0
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL OpAmps\\opamp2 -768 192 R0
SYMATTR InstName U2
SYMATTR Value LM393
SYMBOL OpAmps\\opamp2 -176 512 R0
SYMATTR InstName U3
SYMATTR Value LM393
SYMBOL res 1008 -64 R0
SYMATTR InstName R9
SYMATTR Value 15k
SYMBOL res 1008 64 R0
SYMATTR InstName R10
SYMATTR Value 5.6k
SYMBOL OpAmps\\ADTL082 -464 208 R0
SYMATTR InstName U4
SYMBOL OpAmps\\ADTL082 -864 656 R0
SYMATTR InstName U5
SYMBOL voltage -1696 576 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 11
SYMBOL OpAmps\\ADTL082 352 1024 M0
SYMATTR InstName U6
SYMBOL voltage -1392 576 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_Ref
SYMATTR Value 2.5
SYMBOL res 880 -64 R0
SYMATTR InstName Rc
SYMATTR Value 50
SYMBOL cap -688 400 R0
SYMATTR InstName C8
SYMATTR Value 1.5p
SYMBOL cap -32 592 R0
SYMATTR InstName C12
SYMATTR Value 15p
SYMBOL res 640 960 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL cap 592 848 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value 10n
SYMBOL res 688 848 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 10
SYMBOL cap 336 768 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C9
SYMATTR Value 10n
SYMBOL res 432 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL voltage -1824 576 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value -10
SYMBOL cap 368 864 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C10
SYMATTR Value 1n
SYMBOL res 736 1088 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL TL431 512 1216 R180
SYMATTR InstName U7
SYMBOL cap 560 608 R0
SYMATTR InstName C11
SYMATTR Value 10n
TEXT 1760 856 Left 2 !.tran 0 100m 0 0.5m startup
TEXT 1760 744 Left 2 !.param Rpot 100k
TEXT 1760 680 Left 2 !.inc LM393.5_1
TEXT 1760 776 Left 2 !.param R4 100k
TEXT 1760 712 Left 2 !.include LM324.mod
TEXT 2232 664 Left 2 !.options gmin=1e-11
TEXT 2232 696 Left 2 !.options abstol=1e-10
TEXT 2232 728 Left 2 !.options reltol=0.006
TEXT 2240 760 Left 2 !.options cshunt=1e-15
